"""
é€™æ®µç¨‹å¼ç¢¼çš„åŠŸèƒ½æ˜¯ï¼š

ç•¶æœ‰äººæŒ‰ã€ŒğŸ‘ã€ï¼Œæ©Ÿå™¨äººæœƒèª‡çä»–ã€‚
ç•¶æœ‰äººæŒ‰ã€ŒâŒã€ï¼Œæ©Ÿå™¨äººæœƒåˆªæ‰é‚£å‰‡è¨Šæ¯ã€‚
** è€Œä¸”ä¸è«–è¨Šæ¯æœ‰å¤šèˆŠéƒ½æœ‰æ•ˆï¼**
"""

# å¼•å…¥éœ€è¦çš„æ¨¡çµ„ (åƒæ˜¯æ–°å¢æ¡ŒéŠçš„æ“´å……)
import discord

# å•Ÿç”¨æ‰€æœ‰ intents(æ„åœ–)ï¼Œä½¿æ©Ÿå™¨äººèƒ½å¤ ç›£è½æ‰€æœ‰äº‹ä»¶ï¼ˆåŒ…æ‹¬æˆå“¡ã€è¨Šæ¯ã€åæ‡‰ç­‰ï¼‰
intents = discord.Intents.all()
# å»ºç«‹ Discord Client ç‰©ä»¶ (åƒæ˜¯å¬å–šå‡ºé€™éš»ä½ çš„ DC æ©Ÿå™¨äºº)
# ä¸¦å•Ÿç”¨ intents (è®“æ©Ÿå™¨äººèƒ½å¤ è½åˆ°æ‰€æœ‰äº‹ä»¶)
bot = discord.Client(intents=intents)

@bot.event
async def on_raw_reaction_add(payload):
    """on_raw_reaction_add"""
    """é€™å€‹äº‹ä»¶ï¼Œç•¶ä½¿ç”¨è€…æŒ‰ä¸‹åæ‡‰æ™‚æœƒè§¸ç™¼""" 
    # æä¾›é€™å€‹äº‹ä»¶ï¼Œç›¸ç•¶æ–¼å«ä»–è½è©±ã€‚
    # ç•¶æŒ‰ä¸‹åæ‡‰æ™‚ï¼Œå°±æ˜¯å«ä»–åšäº‹ã€‚(åƒæ˜¯å®¶äººå«ä½ åšå®¶äº‹)
    # æ­¤äº‹ä»¶ä¸è«–æŒ‰ä¸‹åæ‡‰çš„è¨Šæ¯æœ‰å¤šèˆŠéƒ½æœ‰æ•ˆã€‚
    """payload"""
    """æ­¤äº‹ä»¶éœ€è¦ä¸€å€‹æ±è¥¿ï¼Œpayload"""
    # å«ä»–åšäº‹ï¼Œè¦çµ¦ä»–åšäº‹å¿…é ˆè¦çš„æ±è¥¿ã€‚(åƒæ˜¯å®¶äººå«ä½ æ´—ç¢—ï¼Œä»–è¦çµ¦ä½ ç¢—)
    # payload æ˜¯ä¸€å€‹åŒ…å«å¤šç¨® id çš„æ±è¥¿ã€‚
    # payload åƒæ˜¯èœå–®ï¼Œä¸Šé¢æœ‰å¾ˆå¤šèœåï¼Œå¯ä»¥è·Ÿå»šå¸«é»èœåå¾—åˆ°èœã€‚
    # æˆ‘å€‘å¯ä»¥é€é payload ä¸Šçš„ id (èœå)ï¼Œé€é api(å»šå¸«)ï¼Œç²å–åˆ°æˆ‘å€‘æƒ³è¦çš„æ±è¥¿(èœ)ï¼Œåƒæ˜¯ userã€reactionã€message ç­‰ç­‰ã€‚
    
    # é€é payload ä¸Šçš„ id é»èœ 
    guild = bot.get_guild(payload.guild_id) # å¾—åˆ°åœ¨ å“ªå€‹ä¼ºæœå™¨ æŒ‰ä¸‹åæ‡‰
    channel = guild.get_channel(payload.channel_id) # å¾—åˆ°åœ¨æŸä¼ºæœå™¨ä¸‹çš„ å“ªå€‹é »é“ æŒ‰ä¸‹åæ‡‰
    message = await channel.fetch_message(payload.message_id) # å¾—åˆ°åœ¨æŸé »é“ä¸‹çš„ å“ªå€‹è¨Šæ¯ æŒ‰ä¸‹åæ‡‰
    user = guild.get_member(payload.user_id) # å¾—åˆ°åœ¨æŸä¼ºæœå™¨ä¸‹çš„ å“ªå€‹ä½¿ç”¨è€… æŒ‰ä¸‹åæ‡‰
    reaction = payload.emoji # å¾—åˆ°æŒ‰ä¸‹çš„åæ‡‰

    # å¦‚æœæŒ‰ ğŸ‘ï¼Œå‰‡ç™¼é€è¨Šæ¯ï¼ŒèªªæŒ‰ä¸‹è®šçš„äººå¾ˆæ£’
    if reaction.name == "ğŸ‘":  
        await channel.send(f"{user.name} å¾ˆæ£’")

    # å¦‚æœæŒ‰ âŒï¼Œå‰‡ç§»é™¤è¨Šæ¯
    elif reaction.name == "âŒ":
        await message.delete()

# åŸ·è¡Œæ©Ÿå™¨äºº
# token è«‹å¡«å…¥ä½ çš„æ©Ÿå™¨äºº token
bot.run(token)